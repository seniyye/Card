(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[795],{23695:function(e,r,n){"use strict";n.r(r),n.d(r,{__N_SSP:function(){return q}});var t=n(77460),u=n(9207),i=n(92847),c=n.n(i),o=n(81504),a=n(74412),s=n(54918),p=n(26611),l=n(97872),d=n(55937),f=n(5632),v=n(2784),b=n(59354),w=n(98204),h=n(61391),y=n(68679),k=n(52322);function m(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function O(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach((function(r){(0,t.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var q=!0;r.default=function(e){var r,n=e.card,t=e.id,i=(0,s.o)(),m=i.user,q=i.initializing,x=(0,p.z$)(),j=(0,y.K)(),E=(0,f.useRouter)(),_=(0,v.useMemo)((function(){return!!j.data&&j.data.some((function(e){return e.publicId===n.publicId}))}),[j.data,n]),C=(0,v.useMemo)((function(){return E.asPath.startsWith("/hi")?"/hi/".concat(t):"/p/".concat(t)}),[t,E]),P=(0,v.useMemo)((function(){return!q&&!!m&&!_}),[q,_,m]),g=(0,v.useMemo)((function(){return!q&&!m}),[q,m]),I=(0,v.useCallback)((function(){var e={pathname:C,query:{preview:void 0}};"undefined"===typeof E.query.preview&&delete e.query.preview,E.push(e,void 0,{scroll:!1,shallow:!0})}),[C,E]),R=(0,v.useCallback)((0,u.Z)(c().mark((function e(){var r,t,u,i,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.publicId){e.next=2;break}return e.abrupt("return");case 2:return r=document.createElement("a"),e.next=5,fetch((0,o.E3)(n.publicId));case 5:return t=e.sent,e.next=8,t.blob();case 8:u=e.sent,i=URL.createObjectURL(u),a=function e(){setTimeout((function(){URL.revokeObjectURL(i),r.removeEventListener("click",e)}),150)},r.setAttribute("href",i),r.setAttribute("download","".concat((0,d.Pp)(n),".vcf")),r.addEventListener("click",a,!1),r.click(),s={pathname:C,query:{c:void 0,preview:void 0}},"undefined"===typeof E.query.preview&&delete s.query.preview,E.push(s,void 0,{scroll:!1,shallow:!0});case 18:case"end":return e.stop()}}),e)}))),[n,C,E]),D=(0,v.useCallback)(function(){var e=(0,u.Z)(c().mark((function e(r){var t,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.publicId){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,a.Fh)(n.publicId,r);case 4:t=e.sent,u={pathname:C,query:{j:t,preview:void 0}},"undefined"===typeof E.query.preview&&delete u.query.preview,E.push(u,void 0,{scroll:!1,shallow:!0});case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[n,C,E]),Z=(0,v.useCallback)(function(){var e=(0,u.Z)(c().mark((function e(r){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_&&n.publicId){e.next=2;break}return e.abrupt("return");case 2:if(!("email"in r)){e.next=5;break}return e.next=5,(0,a.c7)(n.publicId,r.email);case 5:if(!("phone"in r)){e.next=8;break}return e.next=8,(0,a.Vu)(n.publicId,r.phone);case 8:t={pathname:C,query:O(O({},r),{},{c:void 0,preview:void 0})},"undefined"===typeof E.query.preview&&delete t.query.preview,E.push(t,void 0,{scroll:!1,shallow:!0});case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[n,_,C,E]),L=(0,v.useCallback)((function(e){var r={pathname:C,query:{f:e,preview:void 0}};"undefined"===typeof E.query.preview&&delete r.query.preview,E.push(r,void 0,{scroll:!1,shallow:!0})}),[C,E]);return(0,v.useEffect)((function(){"undefined"===typeof E.query.preview&&(null===x||void 0===x||x.logEvent(p.aM.SHARED_CARD_VIEW))}),[x,E.query.preview]),(0,k.jsxs)(l.r0,{color:null===n||void 0===n?void 0:n.color,children:[(0,k.jsx)(b.Z,{card:n,isCardOwner:_,onRequestExchange:L}),g&&(0,k.jsx)(h.Z,{card:n,onCancel:I,onDownloadVCard:R,onExchangeMethodChange:L,onRequestContact:Z,onSendContact:D}),P&&(0,k.jsx)(w.Z,{contact:n,onCancel:I,publicId:null!==(r=null===n||void 0===n?void 0:n.publicId)&&void 0!==r?r:void 0})]})}},14332:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/p/[id]",function(){return n(23695)}])}},function(e){e.O(0,[639,390,739,421,774,888,179],(function(){return r=14332,e(e.s=r);var r}));var r=e.O();_N_E=r}]);